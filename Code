
##Fitting a MLR Model to our Data
#Our data set is called Student_Data
attach(Student_Data)
AvG<- (Student_Data$G1+ Student_Data$G2 +Student_Data$G3)/3
x<-lm(AvG~.-G1-G2-G3, data=Student_Data)
summary(x)
avPlots(x)
attach(Student_Data_P)
AvG_P<- (Student_Data_P$G1+Student_Data_P$G2+Student_Data_P$G3)/3
y<-lm(AvG_P~.-G1-G2-G3, data=Student_Data_P)
avPlots(y)

##Step Wise Selection Code
f = ~ school+sex+age+address+famsize+Pstatus+Medu+Fedu+Mjob+Fjob+reason+guardian+traveltime+studytime+failures+schoolsup+famsup+paid+activities+nursery+higher+internet+romantic+famrel+freetime+goout+Dalc+Walc+health+absences
m0 = lm(AvG ~ failures+schoolsup+sex+famsup+goout+studytime)
m.stepup = step(m0, scope = c(lower = ~failures, upper = f))


#Confidence Interval for Mean Response
prediction.mean<-predict(m.stepup,newdata = data.frame(failures=3,schoolsupyes=0,sexM=0,studytime=3,schoolMS=0,higheryes=1,Medu=3,Dalc=3,absences=10,health=3,romanticyes=0,guardianmother=1, guardianother=0),
                         interval = "confidence", se.fit =T, level = 0.95)
prediction.mean$fit 
